#!/usr/bin/env zx

import { Command } from 'commander';

const program = new Command();

program
	.name('zx task')

program.command('run')
	.description('build and run hyoga')
	.option('-d, --debug', 'debug build')
	.action(async (d) => {
		await $`make ${d ? 'debug' : ''}`;

		$.cwd = 'build'
		const exe = d ? './hyogad.exe' : './hyoga.exe';
		const exit = await $`${exe}`.nothrow();
		console.log(`Process exited with code ${exit.exitCode}`)
	})

program.command('format')
	.description('format source')
	.action(async () => {
		await $`odin fmt src`;
	})

program.parse(process.argv.slice(1));

